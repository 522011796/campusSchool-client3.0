(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1297:function(t,e,r){var content=r(1352);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(62).default)("548b4fae",content,!0,{sourceMap:!1})},1351:function(t,e,r){"use strict";var l=r(1297);r.n(l).a},1352:function(t,e,r){(e=r(61)(!1)).push([t.i,".header-title-block[data-v-5e846832]{height:60px;line-height:60px;width:100%}.content-block[data-v-5e846832]{border-top-left-radius:10px;border-top-right-radius:10px;border-bottom-left-radius:10px;border-bottom-right-radius:10px;background:#fff}.title-block-tag[data-v-5e846832]{display:inline-block;height:20px;width:3px;background:#e6a23c;font-weight:700;border-radius:3px}.title-block-text[data-v-5e846832]{font-weight:700;position:relative;top:-5px}",""]),t.exports=e},1397:function(t,e,r){"use strict";r.r(e);r(162),r(131),r(132),r(723),r(77);var l=r(15),n=r(22),o=r(51),d=r(129),c=(r(47),{name:"appServerForm",layout:"defaultAppScreen",mixins:[d.a],data:function(){return{rateValue:0,serverDetailTitle:"",serverDetail:"",fApi:{},formCreateRuleData:[],formCreateOptionData:{},btnLoading:!1,customUserStatus:!1,fromCreateBtnShow:!0,showCollapse:!1,fromCreateBtnText:"",auditUsers:[],auditSelUser:[],activeName:""}},mounted:function(){this.$nextTick((function(){}))},created:function(){this.init()},methods:{layoutInit:function(){},init:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],l={id:t.$route.query.id},e.next=4,t.getSessionInfo();case 4:t.$axios.get(n.a.server_form_allInfo,{params:l}).then((function(e){if(200==e.data.code){var l=[];t.serverDetail=e.data.data,t.serverDetailTitle=e.data.data.des?e.data.data.des.substr(0,50)+"...":"";var n=e.data.data.processList;t.customUserStatus=!1,t.fromCreateBtnShow=e.data.data.submitButton,t.fromCreateBtnText=""!=e.data.data.buttonName?e.data.data.buttonName:t.$t("提交"),null!=e.data.data.formContent&&""!=e.data.data.formContent&&(t.formCreateRuleData=JSON.parse(e.data.data.formContent).rule,t.formCreateOptionData=JSON.parse(e.data.data.formContent).option,t.setFormChildren(t.formCreateRuleData,r,"children"));for(var i=0;i<n.length;i++)if("CustomUser"==n[i].htype){for(var o=n[i].hid,d=n[i].hname,c=0;c<o.length;c++)l.push({label:d[c],value:o[c],text:d[c]});t.customUserStatus=!0}t.auditUsers=l}}));case 5:case"end":return e.stop()}}),e)})))()},setFormChildren:function(t,e,param){var r=this;if(t&&t.length>0)return t.map((function(t,l){null!=t[param]&&t[param].length>0?r.setFormChildren(t[param],e,param):"upload"==t.type&&(t.props={uploadType:"image",action:"/proxy/school/multipartFile/upload",data:{path:"applet"},onSuccess:function(t,e){var r="";if(""!=t.data.url&&t.data.url.indexOf("files")>-1){t.data.url.split("files")[0];r="https://campus.9451.com:28090/files/"+t.data.url.split("files")[1]}e.url=r,console.log(r)}})})),e},serverSubBlock:function(){var t=this;this.fApi.submit((function(e,r){var l;if(0!=t.auditSelUser.length||1!=t.customUserStatus){var d={appletFormId:t.$route.query.id,userId:t.loginUserId,customHandleUserIds:JSON.stringify(t.auditSelUser)},c=r.rule,f=t.setRuleChild(c,[]);d.applyContent=JSON.stringify(f),l=n.a.server_form_add,d=t.$qs.stringify(d),t.btnLoading=!0,t.$axios.post(l,d,{loading:!1}).then((function(e){e.data.code,Object(o.a)(e.data.desc),t.btnLoading=!1}))}else Object(o.a)(t.$t("请选择审批人！"))}))},returnBlock:function(){var t=this.$route.query.page?this.$route.query.page:"/app/appIndex";this.$router.push({path:t,query:{id:this.$route.query.id,activeType:this.$route.query.activeType,userType:this.loginUserAppType,navH:this.navHeight,appType:this.globalAppShow,sessionId:this.$route.query.sessionId}})},setRuleChild:function(t,e){for(var r={},i=0;i<t.length;i++)t[i].children&&t[i].children.length>0?this.setRuleChild(t[i].children,e):t[i].field&&(r={field:t[i].field,title:t[i].title,type:t[i].type,value:t[i].value},e.push(r));return e}}}),f=(r(1351),r(45)),component=Object(f.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{class:4==t.loginUserAppType?"bg-app-success_teacher":"bg-app-success",style:{height:t.navHeight+"px"}}),t._v(" "),r("div",{staticClass:"header-title-block color-white",class:4==t.loginUserAppType?"bg-app-success_teacher":"bg-app-success"},[r("van-row",[r("van-col",{attrs:{span:"6"}},[r("div",{staticClass:"text-left padding-lr-10"},[r("span",{staticClass:"font-bold font-size-14",on:{click:t.returnBlock}},[r("i",{staticClass:"fa fa-chevron-left"}),t._v("\n            "+t._s(t.$t("返回"))+"\n          ")])])]),t._v(" "),r("van-col",{attrs:{span:"18"}},[r("div",{staticClass:"text-right padding-lr-10"},[1==t.customUserStatus?[r("el-select",{staticStyle:{width:"130px"},attrs:{size:"small",multiple:"","collapse-tags":"",placeholder:"请选择审批人"},model:{value:t.auditSelUser,callback:function(e){t.auditSelUser=e},expression:"auditSelUser"}},t._l(t.auditUsers,(function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)]:t._e(),t._v(" "),r("span",{staticStyle:{position:"relative",top:"-5px"}},[1==t.fromCreateBtnShow?r("van-button",{attrs:{plain:"",size:"small",type:"primary",loading:t.btnLoading},on:{click:function(e){return t.serverSubBlock(e)}}},[r("i",{staticClass:"fa fa-edit"}),t._v("\n              "+t._s(t.fromCreateBtnText)+"\n            ")]):t._e()],1)],2)])],1)],1),t._v(" "),r("div",{staticStyle:{"margin-top":"1px"}},[r("div",{staticClass:"content-block padding-tb-10",staticStyle:{background:"#f5f5f5"},style:t.divHeight7},[r("div",{staticClass:"color-muted font-size-12 bg-white padding-lr-10 padding-tb-10"},[r("span",[r("label",{staticClass:"title-block-tag"}),t._v(" "),r("label",{staticClass:"title-block-text color-warning"},[t._v(t._s(t.$t("服务简介")))])])]),t._v(" "),r("div",{staticClass:"bg-white padding-lr-10",staticStyle:{"padding-bottom":"10px"}},[r("div",[t.serverDetail.des&&""!=t.serverDetail.des?[0==t.showCollapse?r("div",{on:{click:function(e){t.showCollapse=!t.showCollapse}}},[r("span",[t._v(t._s(t.serverDetailTitle))]),t._v(" "),t._m(0)]):t._e(),t._v(" "),r("el-collapse-transition",[1==t.showCollapse?r("div",{directives:[{name:"show",rawName:"v-show",value:t.showCollapse,expression:"showCollapse"}],on:{click:function(e){t.showCollapse=!1}}},[t._v("\n                "+t._s(t.serverDetail.des)+"\n                "),r("span",[r("i",{staticClass:"fa fa-angle-up pull-right"})])]):t._e()])]:[r("van-empty",{staticStyle:{padding:"0px !important"},attrs:{description:"暂无数据","image-size":"50"}})]],2)]),t._v(" "),r("div",{staticClass:"margin-top-10 bg-white"},[r("div",{staticClass:"color-muted font-size-12 bg-white padding-lr-10 padding-tb-10"},[r("span",[r("label",{staticClass:"title-block-tag"}),t._v(" "),r("label",{staticClass:"title-block-text color-warning"},[t._v(t._s(t.$t("表单内容")))])])]),t._v(" "),r("div",{staticClass:"margin-right-10 margin-left-10"},[""!=t.formCreateRuleData?r("form-create",{attrs:{rule:t.formCreateRuleData,option:t.formCreateOptionData},model:{value:t.fApi,callback:function(e){t.fApi=e},expression:"fApi"}}):t._e()],1)])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i",{staticClass:"fa fa-angle-down pull-right"})])}],!1,null,"5e846832",null);e.default=component.exports}}]);